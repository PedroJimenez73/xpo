<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>XPO Logistics Test</title>
	<link rel="stylesheet" href="../shared/style.css">
	<script src="../shared/js/jquery.min.js"></script>
	<script src="../shared/scormfunctions.js" type="text/javascript"></script>
</head>
<body>
	<div class="contenedor lesson">
    <div class="actividades mostrada">
      <h2>¿Qué jugador ganó varias ligas de la NBA con los Chicago Bulls?</h2>
      <hr>
      <div class="respuesta">
        <input type="radio" class="pregunta-1" id="una-1" name="pregunta-1" value="si">
        <label for="una-1">Michael Jordan</label>
      </div>
      <div class="respuesta">
        <input type="radio" class="pregunta-1" id="una-2" name="pregunta-1" value="no">
        <label for="una-2">Earvin 'Magic' Johnson</label>
      </div>
      <div class="respuesta">
        <input type="radio" class="pregunta-1" id="una-3" name="pregunta-1" value="no">
        <label for="una-3">Larry Bird</label>
      </div>
      <div class="respuesta">
        <input type="radio" class="pregunta-1" id="una-4" name="pregunta-1" value="no">
        <label for="una-4">Scottie Pippen</label>
      </div>
      <div class="botonera">
        <button id="btn-1" class="outline" onclick="nextQuestion()">Siguiente</button>
      </div>
    </div>
    <div class="actividades">
      <h2>¿Quién fué el primer jugador español de la NBA?</h2>
      <hr>
      <div class="respuesta">
        <input type="radio" class="pregunta-2" id="dos-1" name="pregunta-2" value="no">
        <label for="dos-1">Pau Gasol</label>
      </div>
      <div class="respuesta">
        <input type="radio" class="pregunta-2" id="dos-2" name="pregunta-2" value="no">
        <label for="dos-2">Juan Antonio Corbalán</label>
      </div>
      <div class="respuesta">
        <input type="radio" class="pregunta-2" id="dos-3" name="pregunta-2" value="si">
        <label for="dos-3">Fernando Martín</label>
      </div>
      <div class="respuesta">
        <input type="radio" class="pregunta-2" id="dos-4" name="pregunta-2" value="no">
        <label for="dos-4">Juan Antonio San Epifanio</label>
      </div>
      <div class="botonera">
        <button id="btn-2" class="outline" onclick="nextQuestion()">Siguiente</button>
      </div>
    </div>
    <div class="actividades">
      <h2>Ordena los equipos por número de victorias en la NBA (selecciona y suelta con el ratón)</h2>
      <hr>
      <div class="drag-drop" >
        <div class="drag" id="drag-div" ondrop="drop(event)" ondragover="allowDrop(event)">
          <img class="img-drag" src="../shared/img/lakers.svg" alt="" draggable="true" ondragstart="drag(event)" id="segundo">
          <img class="img-drag" src="../shared/img/celtics.svg" alt="" draggable="true" ondragstart="drag(event)" id="primero">
          <img class="img-drag" src="../shared/img/bulls.svg" alt="" draggable="true" ondragstart="drag(event)" id="tercero">
        </div>
        <div class="drop" id="drop-div">
          <div class="dropable" id="primero" ondrop="drop(event)" ondragover="allowDrop(event)">
            <div>Primero</div>
          </div>
          <div class="dropable" id="segundo" ondrop="drop(event)" ondragover="allowDrop(event)">
            <div>Segundo</div>
          </div>
          <div class="dropable" id="tercero" ondrop="drop(event)" ondragover="allowDrop(event)">
            <div>Tercero</div>
          </div>
        </div>
      </div>
      <div class="botonera">
        <button id="btn-3" class="outline" onclick="nextQuestion()">Siguiente</button>
      </div>
    </div>
    <div class="actividades">
      <h2>Complete el nombre del estado del equipo de cada imagen</h2>
      <hr>
      <div class="cards">
        <div class="card">
          <img src="../shared/img/bulls.svg" alt="">
          <input class="pregunta-4" type="text" placeholder="Completar...">
        </div>
        <div class="card">
          <img src="../shared/img/celtics.svg" alt="">
          <input class="pregunta-4" type="text" placeholder="Completar...">
        </div>
        <div class="card">
          <img src="../shared/img/lakers.svg" alt="">
          <input class="pregunta-4" type="text" placeholder="Completar...">
        </div>
      </div>
      <div class="botonera">
        <button id="btn-4" class="outline" onclick="getSolution()">Enviar</button>
        <button id="btn-5" class="outline" onclick="nextQuestion()">Siguiente</button>
      </div>
    </div>
  </div>
  <div class="actividades">
      <h2>Resultados</h2>
      <hr>
      <p >Nº Preguntas: <span>4</span></p>
      <p >Nº Aciertos: <span id="aciertos"></span></p>
      <p >% Aciertos: <span id="porcent-aciertos"></span></p>
      <div class="botonera">
        <button class="outline" onclick="chechResp()">Comprobar respuestas</button>
        <button class="outline m-l-1em" onclick="resetQuestions()">Reintentar</button>
      </div>
  </div>
  <script>
    var contador = 0;
    var inputs1 = document.querySelectorAll(".pregunta-1");
    var inputs2 = document.querySelectorAll(".pregunta-2");
    var inputs4 = document.querySelectorAll(".pregunta-4");
    var comprob1;
    var comprob2;
    var comprob3 = [];
    var comprob4 = [];
    var aciertos = 0;
    var porcentAciertos = 0;
    var dragDrop = document.getElementsByClassName('drag-drop');
    var dragDiv = document.getElementById('drag-div');
    var imgsDrop = document.getElementsByClassName('img-drag');
    var btn1 = document.getElementById('btn-1');
    var btn2 = document.getElementById('btn-2');
    var btn3 = document.getElementById('btn-3');
    var btn4 = document.getElementById('btn-4');
    var btn5 = document.getElementById('btn-5');
    var intent = true;
    var review = false;

    btn1.style.display = 'none';
    btn2.style.display = 'none';
    btn3.style.display = 'none';
    btn4.style.display = 'none';
    btn5.style.display = 'none';

    for (i = 0; i < inputs1.length; i++) {
      inputs1[i].addEventListener('click', function(){
        btn1.style.display = 'inline';
        console.log('eh!')
      });
    }

    for (i = 0; i < inputs2.length; i++) {
      inputs2[i].addEventListener('click', function(){
        btn2.style.display = 'inline';
      });
    }

    for (i = 0; i < inputs4.length; i++) {
      inputs4[i].addEventListener('change', function () {
          console.log('completado');
      });
    }
    
    function nextQuestion() {
      contador++;
			$(".actividades").not(':eq(contador)').removeClass("mostrada");
			$(".actividades").eq(contador).addClass("mostrada");
    }
		
    function drag(ev) {
      ev.dataTransfer.setData("text", ev.target.id);
    }

    function allowDrop(ev) {
      ev.preventDefault();
    }

    function drop(ev) {
      ev.preventDefault();
      var data = ev.dataTransfer.getData("text");
      ev.target.appendChild(document.getElementById(data));
      comprob3.push({drag: data, drop: ev.target.getAttribute("id")});
      if (comprob3.length > 2) {
        btn3.style.display = 'inline';
      }
    }
    
    function getSolution() {
      contador++;
			$(".actividades").not(':eq(contador)').removeClass("mostrada");
			$(".actividades").eq(contador).addClass("mostrada");
      for (i = 0; i < inputs1.length; i++) {
          if (inputs1[i].checked) {
            if (inputs1[i].value === 'si') {
              comprob1 = { index: i, correct: true }
            } else {
              comprob1 = { index: i, correct: false }           
            }
          } 
        }
      
      for (j = 0; j < inputs2.length; j++) {
          if (inputs2[j].checked) {
            if (inputs2[j].value === 'si') {
              comprob2 = { index: j, correct: true }
            } else {
              comprob2 = { index: j, correct: false }           
            }
          } 
        }

      comprob3.slice(-3);

      for (k = 0; k < inputs4.length; k ++){
        comprob4.push(inputs4[k].value.toLowerCase());
      }
      
      if (comprob1.correct) {
        aciertos++;
      }

      if (comprob2.correct) {
        aciertos++;
      } 

      if (comprob3[0].drag === comprob3[0].drop && 
          comprob3[1].drag === comprob3[1].drop && 
          comprob3[2].drag === comprob3[2].drop ) {
            aciertos++;
      } 

      if (comprob4[0] === 'illinois' && 
          comprob4[1] === 'massachusetts' && 
          comprob4[2] === 'california' ) {
            aciertos++;
      } 

      document.getElementById("aciertos").innerHTML = aciertos;
      porcentAciertos = (aciertos / 4) * 100;
      document.getElementById("porcent-aciertos").innerHTML = String(porcentAciertos).slice(0, 5);

      if (parent.RecordTest){
            parent.RecordTest(parseInt(porcentAciertos));
        }
    }

    function chechResp() {
      contador = 0;
			$(".actividades").not(':eq(contador)').removeClass("mostrada");
			$(".actividades").eq(contador).addClass("mostrada");
      for (i = 0; i < inputs1.length; i++) {
        inputs1[i].classList.add('disabled');
        if (inputs1[i].checked) {
          if (inputs1[i].value === 'si') {
            inputs1[i].classList.add('verdadero');
          } else {
            inputs1[i].classList.add('falso');        
          }
        } 
      }
      for (j = 0; j < inputs2.length; j++) {
        inputs2[j].classList.add('disabled');
        if (inputs2[j].checked) {
          if (inputs2[j].value === 'si') {
            inputs2[j].classList.add('verdadero');
          } else {
            inputs2[j].classList.add('falso');          
          }
        } 
      }
      dragDrop[0].classList.add('disabled');
    }

    function resetQuestions() {
      contador = 0;
			$(".actividades").not(':eq(contador)').removeClass("mostrada");
			$(".actividades").eq(contador).addClass("mostrada");
      comprob1 = {};
      comprob2 = {};
      comprob3 = [];
      comprob4 = [];
      aciertos = 0;
      for (l= 0; l < inputs1.length; l++) {
        inputs1[l].checked = false;
        inputs1[l].classList.remove('disabled');
        inputs1[l].classList.remove('verdadero');
        inputs1[l].classList.remove('falso');  
      }
      for (m= 0; m < inputs2.length; m++) {
        inputs2[m].checked = false;
        inputs2[m].classList.remove('disabled');
        inputs2[m].classList.remove('verdadero');
        inputs2[m].classList.remove('falso'); 
      }
      dragDrop[0].classList.remove('disabled');
      for (o= 0; o < imgsDrop.length; o++) {
          dragDiv.appendChild(imgsDrop[o]);
      }
      for (p= 0; p < inputs4.length; p++) {
        inputs4[p].value = '';
      }
    }

    //called from the assessmenttemplate.html page to record the results of a test
    //passes in score as a percentage
    function RecordTest(score){
        ScormProcessSetValue("cmi.core.score.raw", score);
        ScormProcessSetValue("cmi.core.score.min", "0");
        ScormProcessSetValue("cmi.core.score.max", "100");
        
        //if we get a test result, set the lesson status to passed/failed instead of completed
        //consider 50% to be passing
        if (score >= 50){
            ScormProcessSetValue("cmi.core.lesson_status", "passed");
        }
        else{
            ScormProcessSetValue("cmi.core.lesson_status", "failed");
        }
    }
  </script>
</body>
</html>